

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>thermoFBA &mdash; The COBRA Toolbox</title>
  

  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_static/img/apple-touch-icon.png">
  
  
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_static/img/favicon-32x32.png">
  
  
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_static/img/favicon-16x16.png">
  
  
    <link rel="mask-icon" href="../../../../_static/img/safari-pinned-tab.svg" color="#5bbad5">
  
  
    <link rel="manifest" href="../../../../_static/json/manifest.json">
  
  
    <meta name="msapplication-config" content="../../../../_static/browserconfig.xml">
  
  <meta name="theme-color" content="#ffffff">


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
  <script src="../../../../_static/js/jquery.easy-autocomplete.min.js" type="text/javascript" ></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href="../../../../_static/css/easy-autocomplete.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/cobra.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="../../../../_static/css/cobra.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../../search.html"/>
    <link rel="top" title="The COBRA Toolbox" href="../../../../index.html"/>
        <link rel="up" title="Thermo" href="../index.html"/>
        <link rel="next" title="Transport" href="../transport/index.html"/>
        <link rel="prev" title="reactantContribution" href="../reactantContribution/index.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> The COBRA Toolbox
          

          
            <img src="https://king.nuigalway.ie/cobratoolbox/img/cobratoolbox_logo_transparent.png" class="logo" alt="cobratoolbox logo" />
          
          </a>

              
          <h1>The COBRA Toolbox</h1>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" id="simple"/>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
    <script>
    	var options = {

		url: "../../../../_static/json/functions.json",

		getValue: "name",

		list: {
            onKeyEnterEvent: function(item) {
                    return "_static/../" + item.website_url
            },
            maxNumberOfElements: 25,
			match: {
					enabled: true,
			},
            sort: {
			    enabled: true
		    }
		},

    	template: {
	    	type: "custom",
		    method: function(value, item) {
                return "<span><a href='../../../../search.html?q=" + item.name + "&check_keywords=yes&area=default'>" + value + "</a>" + "<a href='../../../../_static/../" + item.website_url + "' ><img src='../../../../_static/link.svg'/></a></span>";
		    }
	    },

		theme: "square"

	};

	$("#simple").easyAutocomplete(options);


    </script>
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../../../index.html">Home</a></li>
              </ul>
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">Analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../coupling/index.html">Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../deletion/index.html">Deletion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../dynamicFBA/index.html">Dynamic FBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../exploration/index.html">Exploration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../FBA/index.html">FBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../findMIIS/index.html">findMIIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../fluxEnrichmentAnalysis/index.html">fluxEnrichmentAnalysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../FVA/index.html">FVA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geometricFBA/index.html">geometricFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../gMCS/index.html">gMCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../KLdistance/index.html">KLdistance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../mdFBA/index.html">mdFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../MOMA/index.html">MOMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../multiSpecies/index.html">MultiSpecies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../parsimoniousFBA/index.html">parsimoniousFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../relaxedFBA/index.html">relaxedFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rFBA/index.html">rFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rMTA/index.html">rMTA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../robustnessAnalysis/index.html">robustnessAnalysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ROOM/index.html">ROOM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rumba/index.html">rumba</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sampling/index.html">Sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../sparseFBA/index.html">sparseFBA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../subspaces/index.html">Subspaces</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html">Thermo</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../componentContribution/index.html">componentContribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../directionalityReport/index.html">directionalityReport</a></li>
<li class="toctree-l4"><a class="reference internal" href="../experimentalDesign/index.html">experimentalDesign</a></li>
<li class="toctree-l4"><a class="reference internal" href="../experimentalData/index.html">experimentalData</a></li>
<li class="toctree-l4"><a class="reference internal" href="../groupContribution/index.html">groupContribution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../inchi/index.html">inchi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../molFiles/index.html">molFiles</a></li>
<li class="toctree-l4"><a class="reference internal" href="../protons/index.html">protons</a></li>
<li class="toctree-l4"><a class="reference internal" href="../reactantContribution/index.html">reactantContribution</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">thermoFBA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../transport/index.html">Transport</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/index.html">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vonBertalanffy/index.html">vonBertalanffy</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../topology/index.html">Topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../transport/index.html">Transport</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../uFBA/index.html">uFBA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../base/index.html">Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../dataIntegration/index.html">Data integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../design/index.html">Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../reconstruction/index.html">Reconstruction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../visualization/index.html">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../cite.html">How to cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../funding.html">Funding</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../plan.html">Development Plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../contact.html">Contact</a></li>
</ul>

          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">The COBRA Toolbox</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../contents.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Functions</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Analysis</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Thermo</a></li>
      <li class="breadcrumb-item active">thermoFBA</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="https://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="thermofba">
<span id="id1"></span><h1>thermoFBA<a class="headerlink" href="#thermofba" title="Permalink to this heading">¶</a></h1>
<span class="target" id="module-src.analysis.thermo.thermoFBA"></span><dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.addLoopLawConstraints">
<span class="sig-name descname"><span class="pre">addLoopLawConstraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">LPproblem</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">rxnIndex</span></em>, <em class="sig-param"><span class="pre">method</span></em>, <em class="sig-param"><span class="pre">reduce_vars</span></em>, <em class="sig-param"><span class="pre">loopInfo</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.addLoopLawConstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds loop law constraints to LP problem or MILP problem.</p>
<p>USAGE:</p>
<blockquote>
<div><p>[MILPproblem] = addLoopLawConstraints(LPproblem, model, rxnIndex)</p>
</div></blockquote>
<dl>
<dt>INPUTS:</dt><dd><p>LPproblem:      Structure containing the following fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>A - LHS matrix</p></li>
<li><p>b - RHS vector</p></li>
<li><p>c - Objective coeff vector</p></li>
<li><p>lb - Lower bound vector</p></li>
<li><p>ub - Upper bound vector</p></li>
<li><p>osense - Objective sense (-1 max, +1 min)</p></li>
<li><p>csense - Constraint senses, a string containting the constraint sense for
each row in A (‘E’, equality, ‘G’ greater than, ‘L’ less than).</p></li>
<li><p>F - (optional) If <cite>*QP</cite> problem</p></li>
<li><p>vartype - (optional) if <cite>MI*P</cite> problem</p></li>
</ul>
</div></blockquote>
<p>model:          The model for which the loops should be removed</p>
</dd>
<dt>OPTIONAL INPUT:</dt><dd><p>rxnIndex:       The index of variables in LPproblem corresponding to fluxes. Default = <cite>[1:n]</cite>
method:         Indicator which method to use:</p>
<blockquote>
<div><ul class="simple">
<li><p>1 - Two variables for each reaction af, ar</p></li>
<li><p>2 - One variable for each reaction af (default)</p></li>
</ul>
</div></blockquote>
<p>reduce_vars:    Eliminates additional integer variables.  Should be faster in all cases but in practice may not be for some weird reason (default : true).
loopInfo:       Structure containing at least a field named ‘method’,</p>
<blockquote>
<div><p>for the method chosen to build loop constraints whose value can be:
* ‘original’: use the original nullspace for internal reactions (Schellenberger et al., 2009)
* ‘fastSNP’ : use the minimal feasible nullspace found by Fast-SNP (Saa and Nielson, 2016)
* ‘LLC-NS’  : (default): use the minimal feasible nullspace found by solving a MILP (Chan et al., 2017)
* ‘LLC-EFM’ : find whether reactions in cycles are connected by EFMs or not</p>
<blockquote>
<div><p>for faster localized loopless constraints (Chan et al., 2017)</p>
</div></blockquote>
<p>Can contain other fields for LLC preprocessing which might be updated during this function</p>
</div></blockquote>
</dd>
<dt>OUTPUT:</dt><dd><p>MILPproblem:    Problem structure containing the following fields describing an MILP problem:</p>
<blockquote>
<div><ul class="simple">
<li><p>A, b, c, lb, ub - same as before but longer</p></li>
<li><p>vartype - variable type of the MILP problem (‘C’, and ‘B’)</p></li>
<li><p><cite>x0 = []</cite> - Needed for <cite>solveMILPproblem</cite></p></li>
</ul>
</div></blockquote>
<p>loopInfo:       Structure containing preprocessing data for using localized loop constraints (LLCs)</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.checkThermodynamicConsistency">
<span class="sig-name descname"><span class="pre">checkThermodynamicConsistency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">q</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.checkThermodynamicConsistency" title="Permalink to this definition">¶</a></dt>
<dd><p>USAGE:</p>
<blockquote>
<div><p>v = checkThermodynamicConsistency(model, q)</p>
</div></blockquote>
<dl class="simple">
<dt>INPUTS:</dt><dd><p>model:
q:</p>
</dd>
<dt>OUTPUT:</dt><dd><p>v:</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.connectedRxnsByEFM">
<span class="sig-name descname"><span class="pre">connectedRxnsByEFM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">conComp</span></em>, <em class="sig-param"><span class="pre">rxnInLoops</span></em>, <em class="sig-param"><span class="pre">printLevel</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.connectedRxnsByEFM" title="Permalink to this definition">¶</a></dt>
<dd><p>Find reactions lying in internal cycles that are connected by any EFMs.
Used for minimizing the number of constraints for the loopless requirement
when running loopless FVA using localized loopless constraints. This
function requires EFMtool (<cite>CalculateFluxModes.m</cite>) to work.</p>
<dl>
<dt>USAGE:</dt><dd><p>rxnLink = connectedRxnsByEFM(model, conComp, rxnInLoops)</p>
</dd>
<dt>INPUTS:</dt><dd><p>model:      COBRA model
conComp:    reactions connected in the minimal nullspace for internal cycles, computed by <cite>connectedRxnsInNullSpace</cite>
rxnInLoops: n-by-2 logical matrix where n = # of rxns in the model</p>
<blockquote>
<div><p>rxnInLoops(k, 1) = true =&gt; forward direction of the k-th reaction in internal cycles
rxnInLoops(k, 2) = true =&gt; reverse direction of the k-th reaction in internal cycles
Returned by <cite>findMinNull.m</cite></p>
</div></blockquote>
</dd>
<dt>OPTIONAL INPUT:</dt><dd><p>printLevel: true to show messages when the linkage matrix cannot be computed</p>
</dd>
<dt>OUTPUT:</dt><dd><dl class="simple">
<dt>rxnLink:    n-by-n matrix. rxnLink(i, j) = 1 =&gt; reactions i and j are connected</dt><dd><p>by an EFM representing an elementary internal cycle.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.connectedRxnsInNullSpace">
<span class="sig-name descname"><span class="pre">connectedRxnsInNullSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">N</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.connectedRxnsInNullSpace" title="Permalink to this definition">¶</a></dt>
<dd><p>Find connected components for reactions given a minimal feasible nullspace as defined in Chan et al., Bioinfo, 2017.
Two reactions in different connected components imply that no EFM connecting the reactions exists and therefore
EFMs can be calculated in a modular approach. If the nullspace matrix represents the nullspace for reactions
in internal loops, constraints for the loopless requirement are required only for the connected components
involving the reactions required to have no flux through cycles (the target set).</p>
<dl class="simple">
<dt>USAGE:</dt><dd><p>conComp = connectedRxnsInNullSpace(N)</p>
</dd>
<dt>INPUT:</dt><dd><dl class="simple">
<dt>N:       a minimal nullspace matrix spanning the feasible flux space, having the same number row as the number of reactions</dt><dd><p>Can be obtained from either <cite>findMinNull.m</cite> or <cite>fastSNP.m</cite></p>
</dd>
</dl>
</dd>
<dt>OUTPUT:</dt><dd><dl class="simple">
<dt>conComp: connected components for any reactions connected through the nullspace</dt><dd><p>E.g., conComp = [1; 0; 1; 2; 3; 2] means that the 1st and 3rd reactions are in the same
connected component, 4th and 6th also in the same, 5th alone in a connected component and
the 2nd reaction is not in any connected component, which means it is a blocked reaction
under the condition where the nullspace is calculated.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.consistentPotentials">
<span class="sig-name descname"><span class="pre">consistentPotentials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">printLevel</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.consistentPotentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a consistent set of potentials for each metabolite in a biochemical
network, given the directions specified by the bounds on each reaction
i.e. find y0, such that <span class="math notranslate nohighlight">\(S^T y_0 &lt; 0\)</span> for a forward reaction and the opposite
for reverse.</p>
<p>USAGE:</p>
<blockquote>
<div><p>y0 = consistentPotentials(model, printLevel)</p>
</div></blockquote>
<dl>
<dt>INPUTS:</dt><dd><p>model:         structure with fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>.S</p></li>
<li><p>.lb</p></li>
<li><p>.ub</p></li>
</ul>
</div></blockquote>
<p>printLevel:    verbose level</p>
</dd>
<dt>OUTPUT:</dt><dd><p>y0:            consistent set of chemical potentials</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.cycleFreeFlux">
<span class="sig-name descname"><span class="pre">cycleFreeFlux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">V0</span></em>, <em class="sig-param"><span class="pre">C</span></em>, <em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">SConsistentRxnBool</span></em>, <em class="sig-param"><span class="pre">param</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.cycleFreeFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes stoichiometrically balanced cycles from FBA solutions when
possible.</p>
<p>A Matlab implementation of the CycleFreeFlux algorithm from Desouki et
al., 2015. Minimises the one norm of fluxes subject to bounds determined
by input flux.</p>
<p>USAGE:</p>
<blockquote>
<div><p>Vthermo = cycleFreeFlux(V0, C, model, SConsistentRxnBool, relaxBounds);</p>
</div></blockquote>
<dl>
<dt>INPUTS:</dt><dd><p>V0:       <cite>n x k</cite> matrix of <cite>k</cite> FBA solutions
C:        <cite>n x k</cite> matrix of <cite>k</cite> FBA objectives
model:    COBRA model structure with required fields:</p>
<blockquote>
<div><ul class="simple">
<li><p>.S  - <cite>m x n</cite> stoichiometric matrix</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.fastSNP">
<span class="sig-name descname"><span class="pre">fastSNP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.fastSNP" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a minimal feasible basis for all internal cycles using the method
Fast-SNP introduced in Saa and Nielson, Bioinformatics, 2016.</p>
<dl>
<dt>USAGE:</dt><dd><p>N = fastSNP(model, ‘name’, ‘value’, …)</p>
</dd>
<dt>INPUTS</dt><dd><p>model:             COBRA model</p>
</dd>
<dt>OPTIONAL INPUTS:</dt><dd><p>parameters:        solver-specific parameter structure or name-value pair argument for solverCobraLP</p>
</dd>
<dt>OUTPUT:</dt><dd><p>N:                 a minimal feasible basis generating all internal cycles
resInfo:           structure containing the following used parameters/information:</p>
<blockquote>
<div><p><a href="#id2"><span class="problematic" id="id3">*</span></a>.iter:      number of iterations
<a href="#id4"><span class="problematic" id="id5">*</span></a>.iterTime:  time for each iteration
<a href="#id6"><span class="problematic" id="id7">*</span></a>.weight:    the random weight vector used for finding new basis vector
<a href="#id8"><span class="problematic" id="id9">*</span></a>.M:         the bound for minimum/maximum flux
<a href="#id10"><span class="problematic" id="id11">*</span></a>.feasTol:   feasibility tolerance for checking solution feasibility
<a href="#id12"><span class="problematic" id="id13">*</span></a>.tol0:      tolerance for zeros in the basis vector
<a href="#id14"><span class="problematic" id="id15">*</span></a>.epsilon:   tolerance for a new basis vector not</p>
<blockquote>
<div><p>lying in the projection of the current null-space,
i.e. w’(I - P)v &gt;= epsilon or w’(I - P)v &lt;= -epsilon</p>
</div></blockquote>
</div></blockquote>
</dd>
</dl>
<p>Siu Hung Joshua Chan 2017 Nov</p>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.findMinNull">
<span class="sig-name descname"><span class="pre">findMinNull</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">formulation</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.findMinNull" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a minimal null-space for all internal cycles by solving a MILP,
as proposed in Chan et al., 2017.</p>
<dl>
<dt>USAGE:</dt><dd><p>[rxnInLoops, N, loopInfo] = findMinNull(model, formulation, parameters)</p>
</dd>
<dt>INPUT:</dt><dd><p>model:               COBRA model structure</p>
</dd>
<dt>OPTIONAL INPUTS:</dt><dd><dl>
<dt>formulation:         1: solve the MILP problem for a minimal null-space basis</dt><dd><blockquote>
<div><p>in an interlaced fashion by presolving some relaxed LPs to simultaneously
determine the directions of reactions that participate in internal cycles
(default, the quickest way as of 2017 Nov)</p>
</div></blockquote>
<dl class="simple">
<dt>2: directly solve the MILP. Then determine the directions</dt><dd><p>of reactions that participate in internal cycles</p>
</dd>
</dl>
</dd>
</dl>
<p>parameters:          solver-specific parameter structure or name-value pair argument for solverCobraMILP</p>
</dd>
<dt>OUTPUTS:</dt><dd><dl class="simple">
<dt>rxnInLoops:          #rxns-by-2 matrix. rxnInLoops(j, 1) = true =&gt; reverse direction of rxn j in loops</dt><dd><p>rxnInLoops(j, 2) = true =&gt; forward direction of rxn j in loops</p>
</dd>
</dl>
<p>N:                   Minimal feasible null-space matrix for internal cycles
loopInfo:            structure containing the following parameters/information:</p>
<blockquote>
<div><p><a href="#id16"><span class="problematic" id="id17">*</span></a>.M:          the bound for minimum/maximum flux
<a href="#id18"><span class="problematic" id="id19">*</span></a>.minFlux:    minimum flux required for a reaction to be active
<a href="#id20"><span class="problematic" id="id21">*</span></a>.ignoreRxns: rxns with small coefficients that are prechecked</p>
<blockquote>
<div><p>before solving the MILP to avoid numerical issues</p>
</div></blockquote>
<p><a href="#id22"><span class="problematic" id="id23">*</span></a>.nsTime:      wall time for finding the null-space
<a href="#id24"><span class="problematic" id="id25">*</span></a>.nsCPU:      CPU time for finding the null-space
<a href="#id26"><span class="problematic" id="id27">*</span></a>.loopPreprocessCPU:  CPU time for finding the directions of reactions participating in loops
<a href="#id28"><span class="problematic" id="id29">*</span></a>.loopPreprocessTime: wall time for finding the directions of reactions participating in loops</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.metaboliteMassBalancePlot">
<span class="sig-name descname"><span class="pre">metaboliteMassBalancePlot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">metAbbr</span></em>, <em class="sig-param"><span class="pre">solution</span></em>, <em class="sig-param"><span class="pre">N</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.metaboliteMassBalancePlot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the top N reactions producing and consuming a metabolite in a flux solution</p>
<p>USAGE:</p>
<blockquote>
<div><p>metaboliteMassBalancePlot(model, metAbbr, solution, N)</p>
</div></blockquote>
<dl class="simple">
<dt>INPUTS:</dt><dd><p>model:       COBRA model structure
metAbbr:     metabolite abbreviation
solution:    <cite>solveCobraLP</cite> output of a solution to FBA problem
N:           Number of reactions to include for production/consumption</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.printDirectionalityFromBounds">
<span class="sig-name descname"><span class="pre">printDirectionalityFromBounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">model</span></em>, <em class="sig-param"><span class="pre">lb</span></em>, <em class="sig-param"><span class="pre">ub</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.printDirectionalityFromBounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the directionality for each reaction depending on the bounds for
each reaction. Defaults to using <cite>model.lb</cite> &amp;  <cite>model.ub</cite> if none provided</p>
<p>USAGE:</p>
<blockquote>
<div><p>directionality = printDirectionalityFromBounds(model, lb, ub)</p>
</div></blockquote>
<dl class="simple">
<dt>INPUT:</dt><dd><p>model:             COBRA model structure</p>
</dd>
<dt>OPTIONAL INPUTS:</dt><dd><p>lb:                flux lower bounds
ub:                flux upper bounds</p>
</dd>
<dt>OUTPUT:</dt><dd><p>directionality:    <cite>n x 1</cite> cell array of strings with directionality for each reaction</p>
</dd>
</dl>
</dd></dl>

<dl class="mat function">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.processingLLCs">
<span class="sig-name descname"><span class="pre">processingLLCs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">process</span></em>, <em class="sig-param"><span class="pre">varargin</span></em><span class="sig-paren">)</span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.processingLLCs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function contains two different processes for manipulating the
localized loop constraints (LLCs) to formulate a model-specific and
objective-function-specific MILP for finding loopless flux distributions
with a minimal number of binary variables</p>
<dl>
<dt>USAGE:</dt><dd><ol class="arabic simple">
<li><p>Preprocess loop information after calling <cite>addLoopLawConstraints</cite>:
[solveLP, MILPproblem, loopInfo] = processingLLCs(‘preprocess’, loopInfo, LPproblem, model, nRxns, osenseStr, MILPproblem)</p></li>
<li><p>Update the loop constraints for a specific objective vector
[solveLP, MILPproblem] = processingLLCs(‘update’, loopInfo, osenseStr, MILPproblem, objVector)</p></li>
</ol>
</dd>
<dt>INPUTS:</dt><dd><dl class="simple">
<dt>loopInfo:      structure containing info about the loops, initially outputed</dt><dd><p>from <cite>addLoopLawConstraints</cite> and updated by the current function</p>
</dd>
</dl>
<p>LPproblem:     original COBRA LP problem structure
model:         the COBRA model from which LPproblem is constructed
nRxns:         number of reactions in the model (default size(model.S, 2))
osenseStr:     optimization sense of the current problem (e.g., FBA max v_biomass, or FVA min v_PYK)</p>
<blockquote>
<div><p>‘max’ (defaulted) or ‘min’</p>
</div></blockquote>
<dl class="simple">
<dt>MILPproblem:   COBRA MILP problem generated from LPproblem using <cite>addLoopLawConstraints</cite></dt><dd><p>(default generated from LPproblem if not given in the preprocessing call)</p>
</dd>
<dt>objVector:     nRxns-by-1 objective vector for the current optimization problem</dt><dd><p>for updating LLCs (e.g., FVA min v_PYK given fixed v_biomass)</p>
</dd>
</dl>
</dd>
<dt>OUTPUTS:</dt><dd><dl class="simple">
<dt>solveLP:       true if solving LP is sufficient to gaurantee the objective function value</dt><dd><p>is the same as solving MILP with loop constraints</p>
</dd>
</dl>
<p>MILPproblem:   updated MILP problem with LLCs
loopInfo:      updated loopInfo with info about the loops (outputed only for the preprocess call)</p>
</dd>
</dl>
</dd></dl>

<dl class="mat script">
<dt class="sig sig-object mat" id="src.analysis.thermo.thermoFBA.testCheckThermodynamicConsistency">
<span class="sig-name descname"><span class="pre">testCheckThermodynamicConsistency</span></span><a class="headerlink" href="#src.analysis.thermo.thermoFBA.testCheckThermodynamicConsistency" title="Permalink to this definition">¶</a></dt>
<dd><p>load textbook.mat</p>
</dd></dl>

</section>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../transport/index.html" class="btn btn-default float-right" title="Transport" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../reactantContribution/index.html" class="btn btn-default" title="reactantContribution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017-2021, The COBRA Toolbox developers.

    </p>
  </div>
  Built with Sphinx using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'2.0.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/mathjax/MathJax@2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  


  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-TRCMZL1FKK"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-TRCMZL1FKK');
  </script>
    
</body>
</html>