<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Testing chemical and biochemical fidelity</title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.2339992523193px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S5 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S6 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S7 { line-height: 15.5926666259766px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S10 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S11 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S12 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S13 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }
.S14 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S15 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S16 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S17 { min-height: 0px; font-style: italic; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S18 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S19 { text-decoration: underline; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }

.LineNodeBlock {margin: 10px 0 10px 0; background-color: #F7F7F7;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Testing chemical and biochemical fidelity</span></h1><h2 class = "S3"><span class = "S4">Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S4">Reviewer: Almut Heinken, University of Luxembourg.</span></h2><h2 class = "S3"><span class = "S4">Introduction</span></h2><div class = "S5"><span class = "S4">Once a context-specific model is generated, but before a it is used to make predictions of biological relevance, it should be subjected to a range of quantitative and qualitative chemical and biochemical fidelity tests. The stoichiometric consistency tests should not be necessary if one starts with a generic model where the internal reactions are all stoichiometrically consistent then a context-specific model extracted from it should also be stoichiometrically consistent. Beyond chemical fidelity, it is also very important to test biochemical fidelity. Such tests are very specific to the particular biological domain one is modelling. Here we focus on human metabolism and use the Recon3.0model or Recon2.0 model.</span></div><h2 class = "S3"><span class = "S4">PROCEDURE</span></h2><h2 class = "S3"><span class = "S4">Load a model</span></h2><div class = "S5"><span class = "S4">Load Recon2.0model. You may also load your own model.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">modelFileName = </span><span class = "S9">'Recon2.0model.mat'</span><span class = "S10">;</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">modelDirectory = getDistributedModelFolder(modelFileName); </span><span class = "S11">%Look up the folder for the distributed Models.</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">modelFileName= [modelDirectory filesep modelFileName]; </span><span class = "S11">% Get the full path. Necessary to be sure, that the right model is loaded</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10">model = readCbModel(modelFileName);</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10"></span></div></div></div><div class = "S12"><span class = "S4">Display the size of the  model</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10">[nMet,nRxn] = size(model.S);</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">fprintf(</span><span class = "S9">'%6s\t%6s\n'</span><span class = "S8">,</span><span class = "S9">'#mets'</span><span class = "S8">,</span><span class = "S9">'#rxns'</span><span class = "S8">); fprintf(</span><span class = "S9">'%6u\t%6u\t%s%s\n'</span><span class = "S8">,nMet,nRxn,</span><span class = "S9">' totals in '</span><span class = "S10">, model.modelID)</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10"></span></div></div></div><div class = "S12"><span class = "S4">Set the threshold to classify flux into non-zero and zero flux:</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10">threshold=1e-6;</span></div></div></div><div class = "S12"><span class = "S4">Set a solver</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S11">% changeCobraSolver ('gurobi', 'all', 1);</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">changeCobraSolver (</span><span class = "S9">'glpk'</span><span class = "S8">, </span><span class = "S9">'all'</span><span class = "S10">, 1);</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S14"><span class = "S4">Production of mthgxl from 12ppd-S</span></h2><div class = "S5"><span class = "S4">Add sink reactions for either end of the proposed pathway:</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">model = addSinkReactions(model,{</span><span class = "S9">'12ppd_S[c]'</span><span class = "S8">,</span><span class = "S9">'mthgxl[c]'</span><span class = "S10">},[-100 -1; 0 100]);</span></div></div></div><div class = "S12"><span class = "S4">Change the objective to maximise the sink reaction for mthgxl[c]</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">model = changeObjective(model,</span><span class = "S9">'sink_mthgxl[c]'</span><span class = "S10">);</span></div></div></div><div class = "S12"><span class = "S4">Test if it is possible to attain a nonzero objective, and if it is compute a sparse flux vector:</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">sol = optimizeCbModel(model,</span><span class = "S9">'max'</span><span class = "S8">,</span><span class = "S9">'zero'</span><span class = "S10">);</span></div></div></div><div class = "S12"><span class = "S4">Check to see if there is a non-zero flux through the objective</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S15">if </span><span class = "S10">sol.stat==1</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    fprintf(</span><span class = "S9">'%g%s\n'</span><span class = "S8">,sol.v(model.c~=0),</span><span class = "S9">' flux through the sink_mthgxl[c] reaction'</span><span class = "S10">)</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S16">end</span></div></div></div><div class = "S12"><span class = "S4">Display the sparse flux solution, but only the non-zero fluxes, above a specified threshold.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S15">if </span><span class = "S10">sol.stat==1</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    </span><span class = "S15">for </span><span class = "S10">n=1:nRxn</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">        </span><span class = "S15">if </span><span class = "S10">abs(sol.v(n))&gt;threshold</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10">            formula=printRxnFormula(model, model.rxns{n}, 0);</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">            fprintf(</span><span class = "S9">'%10g%15s\t%-60s\n'</span><span class = "S10">,sol.v(n),model.rxns{n}, formula{1});</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">        </span><span class = "S16">end</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    </span><span class = "S16">end</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S16">end</span></div></div></div><div class = "S12"><span class = "S2"> ANTICIPATED RESULTS</span></div><div class = "S5"><span class = "S4">If FBAsol.stat==1 then it is feasible to produce methylglyoxal from (S)-propane-1,2-diol. If FBAsol.stat==0, then this metabolic function is infeasible. This is not anticipated and indicates that further gap filling is required (cf Gap Filling Tutorial).</span></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S14"><span class = "S4">Metabolic task: 4abut -&gt; succ[m]</span></h2><div class = "S5"><span class = "S4">Add sink reactions for either end of the proposed pathway:</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">model = addSinkReactions(model,{</span><span class = "S9">'4abut[c]'</span><span class = "S8">,</span><span class = "S9">'succ[m]'</span><span class = "S10">},[-100 -1; 0 100]);</span></div></div></div><div class = "S12"><span class = "S4">Change the objective to maximise the sink reaction for nh4[c]</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">model = changeObjective(model,</span><span class = "S9">'sink_succ[m]'</span><span class = "S10">);</span></div></div></div><div class = "S12"><span class = "S4">Test if it is possible to attain a nonzero objective, and if it is compute a sparse flux vector:</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">sol = optimizeCbModel(model,</span><span class = "S9">'max'</span><span class = "S8">,</span><span class = "S9">'zero'</span><span class = "S10">);</span></div></div></div><div class = "S12"><span class = "S4">Check to see if there is a non-zero flux through the objective</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S15">if </span><span class = "S10">sol.stat==1</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    fprintf(</span><span class = "S9">'%g%s\n'</span><span class = "S8">,sol.v(model.c~=0),</span><span class = "S9">' flux through the sink_succ[m] reaction'</span><span class = "S10">)</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S16">end</span></div></div></div><div class = "S12"><span class = "S4">Dis</span><span class = "S4">play the sparse flux solution, but only the non-zero fluxes, above a specified threshold.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S15">if </span><span class = "S10">sol.stat==1</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    </span><span class = "S15">for </span><span class = "S10">n=1:nRxn</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">        </span><span class = "S15">if </span><span class = "S10">abs(sol.v(n))&gt;threshold</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10">            formula=printRxnFormula(model, model.rxns{n}, 0);</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">            fprintf(</span><span class = "S9">'%10g%15s\t%-60s\n'</span><span class = "S10">,sol.v(n),model.rxns{n}, formula{1});</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">        </span><span class = "S16">end</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    </span><span class = "S16">end</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S16">end</span></div></div></div><div class = "S12"><span class = "S2"> ANTICIPATED RESULTS</span></div><div class = "S5"><span class = "S4">If FBAsol.stat==1 then it is feasible to produce mitochondrial succinate from 4-Aminobutanoate. If FBAsol.stat==0, then this metabolic function is infeasible. This is not anticipated and indicates that further gap filling is required (cf Gap Filling Tutorial).</span></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S14"><span class = "S4">Metabolic task: gly -&gt; co2 and nh4 (via glycine cleavage system)</span></h2><div class = "S5"><span class = "S4">Add sink reactions for either end of the proposed pathway:</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">model = addSinkReactions(model,{</span><span class = "S9">'gly[c]'</span><span class = "S8">,</span><span class = "S9">'co2[c]'</span><span class = "S8">,</span><span class = "S9">'nh4[c]'</span><span class = "S10">},[-100 -1; 0.1 100; 0.1 100]);</span></div></div></div><div class = "S12"><span class = "S4">Change the objective to maximise the sink reaction for nh4[c]</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">model = changeObjective(model,</span><span class = "S9">'sink_nh4[c]'</span><span class = "S10">);</span></div></div></div><div class = "S12"><span class = "S4">Test if it is possible to attain a nonzero objective, and if it is compute a sparse flux vector:</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">sol = optimizeCbModel(model,</span><span class = "S9">'max'</span><span class = "S8">,</span><span class = "S9">'zero'</span><span class = "S10">);</span></div></div></div><div class = "S12"><span class = "S4">Check to see if there is a non-zero flux through the objective</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S15">if </span><span class = "S10">sol.stat==1</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    fprintf(</span><span class = "S9">'%g%s\n'</span><span class = "S8">,sol.v(model.c~=0),</span><span class = "S9">' flux through the sink_nh4[c] reaction'</span><span class = "S10">)</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S16">end</span></div></div></div><div class = "S12"><span class = "S4">Dis</span><span class = "S4">play the sparse flux solution, but only the non-zero fluxes, above a specified threshold.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S15">if </span><span class = "S10">sol.stat==1</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    </span><span class = "S15">for </span><span class = "S10">n=1:nRxn</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">        </span><span class = "S15">if </span><span class = "S10">abs(sol.v(n))&gt;threshold</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S10">            formula=printRxnFormula(model, model.rxns{n}, 0);</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">            fprintf(</span><span class = "S9">'%10g%15s\t%-60s\n'</span><span class = "S10">,sol.v(n),model.rxns{n}, formula{1});</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">        </span><span class = "S16">end</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S8">    </span><span class = "S16">end</span></div></div><div class = 'inlineWrapper'><div class = "S7 lineNode"><span class = "S16">end</span></div></div></div><div class = "S12"><span class = "S2"> ANTICIPATED RESULTS</span></div><div class = "S5"><span class = "S4">If FBAsol.stat==1 then it is feasible to produce CO2 and NH4 from glycine. If FBAsol.stat==0, then this metabolic function is infeasible. This is not anticipated and indicates that further gap filling is required (cf Gap Filling Tutorial).</span></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S14"><span class = "S4">REFERENCES</span></h2><div class = "S5"><span class = "S4">[fleming_cardinality_nodate] Fleming, R.M.T., et al., Cardinality optimisation in constraint-based modelling: illustration with Recon 3D (submitted), 2017.</span></div><div class = "S5"><span class = "S17"> </span><span class = "S4">[</span><a href = "https://localhost:31515/toolbox/matlab/codetools/liveeditor/index.html?id=1016607495&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Creconstruction%5CfidelityTesting%5Ctutorial_fidelityTesting.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3666778367582928196&amp;snc=AR9962#LyXCite-sparsePaper"><span class = "S19">sparsePaper</span></a><span class = "S4">] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span class = "S4"> </span><span class = "S4">optimization</span><span class = "S4">. European Journal of Operational Research 244, 26–46.</span></div><div class = "S5"><span class = "S17"></span></div></div></div>
<!-- 
##### SOURCE BEGIN #####
%% *Testing chemical and biochemical fidelity*
%% Authors: Ronan Fleming, Ines Thiele, University of Luxembourg.
%% Reviewer: Almut Heinken, University of Luxembourg.
%% Introduction
% Once a context-specific model is generated, but before a it is used to make 
% predictions of biological relevance, it should be subjected to a range of quantitative 
% and qualitative chemical and biochemical fidelity tests. The stoichiometric 
% consistency tests should not be necessary if one starts with a generic model 
% where the internal reactions are all stoichiometrically consistent then a context-specific 
% model extracted from it should also be stoichiometrically consistent. Beyond 
% chemical fidelity, it is also very important to test biochemical fidelity. Such 
% tests are very specific to the particular biological domain one is modelling. 
% Here we focus on human metabolism and use the Recon3.0model or Recon2.0 model.
%% PROCEDURE
%% Load a model
% Load Recon2.0model. You may also load your own model.

modelFileName = 'Recon2.0model.mat';
modelDirectory = getDistributedModelFolder(modelFileName); %Look up the folder for the distributed Models.
modelFileName= [modelDirectory filesep modelFileName]; % Get the full path. Necessary to be sure, that the right model is loaded
model = readCbModel(modelFileName);

%% 
% Display the size of the  model

[nMet,nRxn] = size(model.S);
fprintf('%6s\t%6s\n','#mets','#rxns'); fprintf('%6u\t%6u\t%s%s\n',nMet,nRxn,' totals in ', model.modelID)

%% 
% Set the threshold to classify flux into non-zero and zero flux:

threshold=1e-6;
%% 
% Set a solver

% changeCobraSolver ('gurobi', 'all', 1);
changeCobraSolver ('glpk', 'all', 1);
%% Production of mthgxl from 12ppd-S
% Add sink reactions for either end of the proposed pathway:
%%
model = addSinkReactions(model,{'12ppd_S[c]','mthgxl[c]'},[-100 -1; 0 100]);
%% 
% Change the objective to maximise the sink reaction for mthgxl[c]

model = changeObjective(model,'sink_mthgxl[c]');
%% 
% Test if it is possible to attain a nonzero objective, and if it is compute 
% a sparse flux vector:

sol = optimizeCbModel(model,'max','zero');
%% 
% Check to see if there is a non-zero flux through the objective

if sol.stat==1
    fprintf('%g%s\n',sol.v(model.c~=0),' flux through the sink_mthgxl[c] reaction')
end
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified threshold.

if sol.stat==1
    for n=1:nRxn
        if abs(sol.v(n))>threshold
            formula=printRxnFormula(model, model.rxns{n}, 0);
            fprintf('%10g%15s\t%-60s\n',sol.v(n),model.rxns{n}, formula{1});
        end
    end
end
%% 
% * ANTICIPATED RESULTS*
% 
% If FBAsol.stat==1 then it is feasible to produce methylglyoxal from (S)-propane-1,2-diol. 
% If FBAsol.stat==0, then this metabolic function is infeasible. This is not anticipated 
% and indicates that further gap filling is required (cf Gap Filling Tutorial).
%% Metabolic task: 4abut -> succ[m]
% Add sink reactions for either end of the proposed pathway:
%%
model = addSinkReactions(model,{'4abut[c]','succ[m]'},[-100 -1; 0 100]);
%% 
% Change the objective to maximise the sink reaction for nh4[c]

model = changeObjective(model,'sink_succ[m]');
%% 
% Test if it is possible to attain a nonzero objective, and if it is compute 
% a sparse flux vector:

sol = optimizeCbModel(model,'max','zero');
%% 
% Check to see if there is a non-zero flux through the objective

if sol.stat==1
    fprintf('%g%s\n',sol.v(model.c~=0),' flux through the sink_succ[m] reaction')
end
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified threshold.

if sol.stat==1
    for n=1:nRxn
        if abs(sol.v(n))>threshold
            formula=printRxnFormula(model, model.rxns{n}, 0);
            fprintf('%10g%15s\t%-60s\n',sol.v(n),model.rxns{n}, formula{1});
        end
    end
end
%% 
% * ANTICIPATED RESULTS*
% 
% If FBAsol.stat==1 then it is feasible to produce mitochondrial succinate 
% from 4-Aminobutanoate. If FBAsol.stat==0, then this metabolic function is infeasible. 
% This is not anticipated and indicates that further gap filling is required (cf 
% Gap Filling Tutorial).
%% Metabolic task: gly -> co2 and nh4 (via glycine cleavage system)
% Add sink reactions for either end of the proposed pathway:
%%
model = addSinkReactions(model,{'gly[c]','co2[c]','nh4[c]'},[-100 -1; 0.1 100; 0.1 100]);
%% 
% Change the objective to maximise the sink reaction for nh4[c]

model = changeObjective(model,'sink_nh4[c]');
%% 
% Test if it is possible to attain a nonzero objective, and if it is compute 
% a sparse flux vector:

sol = optimizeCbModel(model,'max','zero');
%% 
% Check to see if there is a non-zero flux through the objective

if sol.stat==1
    fprintf('%g%s\n',sol.v(model.c~=0),' flux through the sink_nh4[c] reaction')
end
%% 
% Display the sparse flux solution, but only the non-zero fluxes, above 
% a specified threshold.

if sol.stat==1
    for n=1:nRxn
        if abs(sol.v(n))>threshold
            formula=printRxnFormula(model, model.rxns{n}, 0);
            fprintf('%10g%15s\t%-60s\n',sol.v(n),model.rxns{n}, formula{1});
        end
    end
end
%% 
% * ANTICIPATED RESULTS*
% 
% If FBAsol.stat==1 then it is feasible to produce CO2 and NH4 from glycine. 
% If FBAsol.stat==0, then this metabolic function is infeasible. This is not anticipated 
% and indicates that further gap filling is required (cf Gap Filling Tutorial).
%% REFERENCES
% [fleming_cardinality_nodate] Fleming, R.M.T., et al., Cardinality optimisation 
% in constraint-based modelling: illustration with Recon 3D (submitted), 2017.
% 
% _ _[<#LyXCite-sparsePaper sparsePaper>] Le Thi, H.A., Pham Dinh, T., Le, 
% H.M., and Vo, X.T. (2015). DC approximation approaches for sparse optimization. 
% European Journal of Operational Research 244, 26–46.
% 
% __
##### SOURCE END #####
--></body></html>