<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="generator" content="MATLAB R2016a"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><title>Find leakage and siphon modes in a reconstruction  </title><style type="text/css">
* {margin: 0; padding: 0;}
body {text-align: start; line-height: 17.2339992523193px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Consolas, Inconsolata, Menlo, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; }
h1, h2 {font-weight: normal;}
.content { padding: 30px; }

.S0 { margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S1 { line-height: 26.3999996185303px; min-height: 24px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-size: 22px; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 15px; margin-right: 10px;  }
.S2 { min-height: 0px; font-weight: bold; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S3 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S4 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 15px; margin-bottom: 9px; margin-right: 10px;  }
.S5 { min-height: 0px; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S6 { text-align: center; line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px;  }
.S7 { min-height: 0px; color: rgb(0, 95, 206); margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S8 { text-decoration: underline; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S9 { line-height: 20.576000213623px; min-height: 20px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-size: 16px; font-weight: bold; white-space: pre-wrap; margin-left: 4px; margin-top: 3px; margin-bottom: 9px; margin-right: 10px;  }
.S10 { margin-left: 3px; margin-top: 10px; margin-bottom: 10px; margin-right: 3px;  }
.S11 { line-height: 15.5926666259766px; min-height: 18px; white-space: nowrap; font-size: 12.6666669845581px; white-space: nowrap; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S12 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S13 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S14 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S15 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(160, 32, 240); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 0px;  }
.S16 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S17 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(34, 139, 34); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S18 { line-height: 15.5926675796509px; min-height: 0px; white-space: pre; color: rgb(0, 0, 255); font-size: 12.6666679382324px; white-space: pre; margin-left: 0px; margin-top: 0px; margin-bottom: 0px; margin-right: 45px;  }
.S19 { line-height: 21px; min-height: 17px; white-space: pre-wrap; font-family: Helvetica, Arial, sans-serif; white-space: pre-wrap; margin-left: 4px; margin-top: 10px; margin-bottom: 9px; margin-right: 10px;  }
.S20 { margin-left: 3px; margin-top: 10px; margin-bottom: 4px; margin-right: 3px;  }

.LineNodeBlock {margin: 10px 0 10px 0; background-color: #F7F7F7;}
.LineNodeBlock+.paragraphNode {margin-top: 10px;}
.lineNode {padding-left: 10px; border-left: 1px solid #E9E9E9; border-right: 1px solid #E9E9E9;}
.inlineWrapper:first-child .lineNode,.inlineWrapper.outputs+.inlineWrapper .lineNode {padding-top: 5px; border-top: 1px solid #E9E9E9;}
.inlineWrapper:last-child .lineNode,.inlineWrapper.outputs .lineNode {padding-bottom: 5px; border-bottom: 1px solid #E9E9E9;}
.lineNode .textBox {white-space: pre;}
</style></head><body><div class = "content"><div class = 'SectionBlock containment active'><h1 class = "S1"><span class = "S2">Find leakage and siphon modes in a reconstruction  </span></h1><div class = "S3"><span class = "S2"></span></div><div class = "S3"><span class = "S2">Note: This tutorial is a draft and needs completion. Contributions welcome!</span></div><div class = "S3"><span class = "S2"></span></div><h2 class = "S4"><span class = "S5">Author: Ronan Fleming, University of Luxembourg</span></h2><h2 class = "S4"><span class = "S5">Reviewers: </span></h2><h2 class = "S4"><span class = "S5">INTRODUCTION</span></h2><div class = "S3"><span class = "S5">In standard notation, flux balance analysis is the linear optimisation (1)</span></div><div class = "S6"><span style="vertical-align:-32px"><img src="data:image/png;base64,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" width="108" height="74" /></span></div><div class = "S3"><span class = "S5"></span></div><div class = "S3"><span class = "S5">where </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">c</span><span class = "S5"> </span><span class = "S5"> is a parameter vector that linearly combines one or more reaction fluxes to form what is termed the objective function and where</span><span class = "S5">  b represents some fixed output, or input, of species. If </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">b</span><span class = "S5">=</span><span class = "S5">0</span><span class = "S5">  </span><span class = "S5"> </span><span class = "S5">, a species may be produced from nothing (leak species) or consumed for nothing (siphon species) in violation of mass conservation, if all reactions are reversible and </span><span class = "S5"> </span><span class = "S5">S</span><span class = "S5"> </span><span class = "S5"> is stoichiometrically consistent. However, even with a stoichiometrically inconsistent </span><span class = "S5"> </span><span class = "S5">S, mass conservation may still not be violated if the lower and upper bounds on reaction rates, </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">l</span><span class = "S5">,</span><span class = "S5">u</span><span class = "S5"> prevent it. For instance, the reactions </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">A</span><span class = "S5">+</span><span class = "S5">B</span><span class = "S5"> ⇋ </span><span class = "S5">C</span><span class = "S5">  </span><span class = "S5"> </span><span class = "S5"> and </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">C</span><span class = "S5"> ⇋ </span><span class = "S5">A</span><span class = "S5">  </span><span class = "S5"> </span><span class = "S5"> are stoichiometrically inconsistent because it is impossible to assign a positive molecular mass to all species whilst ensuring that each reaction conserves mass. However, if the bounds are such that both reactions are unidirectional in the forward direction, </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">A</span><span class = "S5">+</span><span class = "S5">B</span><span class = "S5"> → </span><span class = "S5">C</span><span class = "S5">  </span><span class = "S5"> </span><span class = "S5"> and </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">C</span><span class = "S5"> → </span><span class = "S5">A</span><span class = "S5">  </span><span class = "S5"> </span><span class = "S5">, then leakage of </span><span class = "S5"> </span><span class = "S5">B</span><span class = "S5"> </span><span class = "S5"> is no longer possible and so mass is conserved. </span></div><div class = "S3"><span class = "S5">Testing for leaks or siphons has been widely used in genome-scale metabolic modelling, prior to distribution of a model for prediction of mass conserved steady states. One can identify all leaks in a network with the cardinality optimisation problem (2)</span></div><div class = "S6"><span style="vertical-align:-41px"><img src="data:image/png;base64,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" width="109" height="93" /></span></div><div class = "S3"><span class = "S5">where  </span><span class = "S5">y_i</span><span class = "S5">  </span><span class = "S5"> ≠ </span><span class = "S5">0</span><span class = "S5">  </span><span class = "S5"> </span><span class = "S5"> indicates that the corresponding species is a leak and can be produced from nothing. To test for siphons, replace the equality constraint in with </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">S</span><span class = "S5">v</span><span class = "S5">+</span><span class = "S5">y</span><span class = "S5">=</span><span class = "S5">0</span><span class = "S5">. This approach is useful when double checking stoichiometric consistency, with the bounds for all reactions that are known to be stoichiometrically inconsistent set to zero. A minimal number of reactions required to be active and result in a leak of the species subset </span><span class = "S5"> </span><span class = "S5"> Ω </span><span class = "S5"> </span><span class = "S5"> can be found using the cardinality optimisation problem (3)</span></div><div class = "S6"><span style="vertical-align:-53px"><img src="data:image/png;base64,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" width="119" height="117" /></span></div><div class = "S3"><span class = "S5">with the optimal v referred to as a minimal leakage mode [</span><a href = "https://localhost:31515/toolbox/matlab/codetools/liveeditor/index.html?id=438454612&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Creconstruction%5CleakSiphonModes%5Ctutorial_leakSiphonModes.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3666778367582928196&amp;snc=NUEWUW#LyXCite-gevorgyan_detection_2008"><span class = "S8">gevorgyan_detection_2008</span></a><span class = "S5">]. A minimal siphon mode would be obtained if the equality constraint was replaced with </span><span class = "S5"> </span><span class = "S5">  </span><span class = "S5">S</span><span class = "S5">v</span><span class = "S5">+</span><span class = "S5">y</span><span class = "S5">=</span><span class = "S5">0</span><span class = "S5">. Similarly, a minimal number of reactions contributing to leakage of a minimal number of species can be found using the cardinality optimisation problem (4)</span></div><div class = "S6"><span style="vertical-align:-53px"><img src="data:image/png;base64,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" width="119" height="117" /></span></div><div class = "S3"><span class = "S5">where the additional inequality enforces the rate of a subset reactions to be active. The utility of Problems </span><a href = "https://localhost:31515/toolbox/matlab/codetools/liveeditor/index.html?id=438454612&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Creconstruction%5CleakSiphonModes%5Ctutorial_leakSiphonModes.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3666778367582928196&amp;snc=NUEWUW#eq_minimalLeakMet"><span class = "S8">(3)</span></a><span class = "S5"> and </span><a href = "https://localhost:31515/toolbox/matlab/codetools/liveeditor/index.html?id=438454612&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Creconstruction%5CleakSiphonModes%5Ctutorial_leakSiphonModes.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3666778367582928196&amp;snc=NUEWUW#eq_minimalLeakRxn"><span class = "S8">(4)</span></a><span class = "S5"> is in the identification of reactions within the suspect stoichiometrically inconsistent set, to remove prior to reiteration of a test for stoichiometric consistency with a reduced network. This requires manual curation of the results of Problems </span><a href = "https://localhost:31515/toolbox/matlab/codetools/liveeditor/index.html?id=438454612&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Creconstruction%5CleakSiphonModes%5Ctutorial_leakSiphonModes.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3666778367582928196&amp;snc=NUEWUW#eq_minimalLeakMet"><span class = "S8">(3)</span></a><span class = "S5"> and </span><a href = "https://localhost:31515/toolbox/matlab/codetools/liveeditor/index.html?id=438454612&amp;file=U%3A%5Ccobratoolbox-gh-pages%5Cstable%5Ctutorials%5Creconstruction%5CleakSiphonModes%5Ctutorial_leakSiphonModes.mlx&amp;showLineNumbers=false&amp;clipboardtempdirpath=C:\Users\19420624\AppData\Local\Temp\ConnectorClipboard3666778367582928196&amp;snc=NUEWUW#eq_minimalLeakRxn"><span class = "S8">(4)</span></a><span class = "S5">, where the advantage is that they often narrow down significantly the search for stoichiometrically inconsistent reactions, especially in the context of genome-scale networks. This tutorial illustrates the methods to implement the aforementioned problems when debugging the source of stoichiometric inconsistency within a reconstruction as it can be used to find leak or siphon metabolites, as well as minimal cardinality leakage modes and minimal cardinality siphon modes, of various types. </span></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">TIMING</span></h2><div class = "S3"><span class = "S5">Hours to days, depending on how long it takes to biochemically interpret the minimal leakage and siphon modes.</span></div><h2 class = "S4"><span class = "S5">PROCEDURE</span></h2><h2 class = "S4"><span class = "S5">Select reconstruction to convert into a model and enter parameters</span></h2><div class = "S3"><span class = "S5">Load the ReconX reconstruction, and save the original reconstruction in the workspace, unless it is already loaded into the workspace. </span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">clear </span><span class = "S13">model</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S14">if </span><span class = "S12">~exist(</span><span class = "S15">'modelOrig'</span><span class = "S12">,</span><span class = "S15">'var'</span><span class = "S16">)</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    </span><span class = "S17">%select your own model, or use Recon2.0model instead</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    </span><span class = "S14">if </span><span class = "S16">0</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        filename</span><span class = "S12">=</span><span class = "S15">'Recon3.0model'</span><span class = "S16">;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        directory=</span><span class = "S15">'~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels'</span><span class = "S16">;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">        model = loadIdentifiedModel(filename,directory);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    </span><span class = "S18">else</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        filename=</span><span class = "S15">'Recon2.0model.mat'</span><span class = "S16">;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S12">exist(</span><span class = "S15">'Recon2.0model.mat'</span><span class = "S12">,</span><span class = "S15">'file'</span><span class = "S16">)==2</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            model = readCbModel(filename);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    </span><span class = "S18">end</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    model.csense(1:size(model.S,1),1)=</span><span class = "S15">'E'</span><span class = "S16">;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">    modelOrig = model;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S18">else</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">    model=modelOrig;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S18">end</span></div></div></div><div class = "S19"><span class = "S5">Set the level of pri</span><span class = "S5">nting, zero for silent, higher for more output.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">printLevel=2;</span></div></div></div><div class = "S19"><span class = "S5">Choose the directory to place the results</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">basePath=</span><span class = "S15">'~/work/sbgCloud/'</span><span class = "S16">;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">resultsPath=[basePath </span><span class = "S15">'/programReconstruction/projects/recon2models/results/reconXs/' </span><span class = "S16">model.modelID];</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">resultsFileName=[resultsPath filesep model.modelID];</span></div></div></div><div class = "S19"><span class = "S5">Create and enter the folder for the results if it does not already exist</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S14">if </span><span class = "S12">~exist(resultsPath,</span><span class = "S15">'dir'</span><span class = "S16">)</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">    mkdir(resultsPath)</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S18">end</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">cd(resultsPath)</span></div></div></div><div class = "S19"><span class = "S5">Opt</span><span class = "S5">ionally create a diary to save the output in case it is very long, this makes it easier to search, especially when debugging the process during the early stages.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S14">if </span><span class = "S16">0</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    diary</span><span class = "S12">(</span><span class = "S12">[resultsFileName </span><span class = "S15">'_diary.txt'</span><span class = "S16">])</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">Ove</span><span class = "S5">rview some of the key properties of the reconstruction</span></h2><div class = "S3"><span class = "S5">Noting the initial size of the reconstruction is useful for comparisons later with subsets derived according to mathematical specifications.</span></div><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">[nMet,nRxn]=size(model.S);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">fprintf(</span><span class = "S15">'%6s\t%6s\n'</span><span class = "S12">,</span><span class = "S15">'#mets'</span><span class = "S12">,</span><span class = "S15">'#rxns'</span><span class = "S16">)</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">fprintf(</span><span class = "S15">'%6u\t%6u\t%s\n'</span><span class = "S12">,nMet,nRxn,</span><span class = "S15">' totals.'</span><span class = "S16">)</span></div></div></div><div class = "S19"><span class = "S5"></span></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">Find leaka</span><span class = "S5">ge</span><span class = "S5"> or siphons in heuristically internal part using the bounds given with the model</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [leakMetBool,leakRxnBool,siphonMetBool,siphonRxnBool,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S12">]</span><span class = "S18">...</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">                = findMassLeaksAndSiphons(model,model.SIntMetBool,model.SIntRxnBool,modelBoundsFlag,leakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each le</span><span class = "S5">aking metabolite find</span><span class = "S5"> a minimal cardinality leakage mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">        leakParams.epsilon=1e-4;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        minLeakParams.eta = getCobraSolverParams(</span><span class = "S15">'LP'</span><span class = "S12">, </span><span class = "S15">'feasTol'</span><span class = "S16">)*100;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        leakParams.method=</span><span class = "S15">'dc'</span><span class = "S16">;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">        </span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoMetMode=1;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [</span><span class = "S12">minLeakMetBool</span><span class = "S12">,</span><span class = "S12">minLeakRxnBool</span><span class = "S12">,</span><span class = "S12">minSiphonMetBool</span><span class = "S12">,</span><span class = "S12">minSiphonRxnBool</span><span class = "S12">,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S12">] =</span><span class = "S18">...</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">                findMinimalLeakageModeMet(model,leakMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each si</span><span class = "S5">p</span><span class = "S5">hon metabolite find a minimal cardinality siphon mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoMetMode=1;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [</span><span class = "S12">minLeakMetBool</span><span class = "S12">,</span><span class = "S12">minLeakRxnBool</span><span class = "S12">,</span><span class = "S12">minSiphonMetBool</span><span class = "S12">,</span><span class = "S12">minSiphonRxnBool</span><span class = "S12">,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S12">] =</span><span class = "S18">...</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">                findMinimalLeakageModeMet(model,siphonMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each le</span><span class = "S5">a</span><span class = "S5">king metabolite find a minimal cardinality leakage mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoMetMode=0;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [</span><span class = "S12">minLeakMetBool</span><span class = "S12">,</span><span class = "S12">minLeakRxnBool</span><span class = "S12">,</span><span class = "S12">minSiphonMetBool</span><span class = "S12">,</span><span class = "S12">minSiphonRxnBool</span><span class = "S12">,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S12">] =</span><span class = "S18">...</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">                findMinimalLeakageModeMet(model,leakMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each si</span><span class = "S5">p</span><span class = "S5">hon metabolite find a minimal cardinality siphon mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoMetMode=0;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [</span><span class = "S12">minLeakMetBool</span><span class = "S12">,</span><span class = "S12">minLeakRxnBool</span><span class = "S12">,</span><span class = "S12">minSiphonMetBool</span><span class = "S12">,</span><span class = "S12">minSiphonRxnBool</span><span class = "S12">,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S12">] =</span><span class = "S18">...</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">                findMinimalLeakageModeMet(model,siphonMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each he</span><span class = "S5">u</span><span class = "S5">ristically internal but stoichiometrically inconsistent reaction (one at a time), find the min cardinality leakage mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            rxnBool=model.SIntRxnBool &amp; model.SInConsistentRxnBool;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            metBool=true(nMet,1);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoRxnMode=1;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [</span><span class = "S12">minLeakMetBool</span><span class = "S12">,</span><span class = "S12">minLeakRxnBool</span><span class = "S12">,</span><span class = "S12">minSiphonMetBool</span><span class = "S12">,</span><span class = "S12">minSiphonRxnBool</span><span class = "S12">,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S12">] =</span><span class = "S18">...</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">                findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">        </span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% An example of a minimal cardinality leakage mode that causes leakage of no2[c]:</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%  #mets	 #rxns	  mode	        rxnAbbr	    lb	    ub	 newlb	 newub</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%      1	     2	  leak	        RE2704C	     0	     0	     1	     2</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% If there are a small number of reactions, the formulae for the set of</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% reactions in the minimal leakage mode are displayed:</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% RE2704C	yvite[c] 	-&gt;	h[c] + no2[c] + CE7047[c]</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% HMR_6456	h[c] + CE7047[c] 	&lt;=&gt;	yvite[c]</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% If RE2704C goes in the forward direction and HMR_6456 in reverse, then</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% no2[c] will leak from the network. One or other of these reactions have</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% the incorrect stoichiometry.</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% Here is a minimal leakage mode resulting in leakage of one metabolite</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%  #mets	 #rxns	  mode	        rxnAbbr	    lb	    ub	 newlb	 newub</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%      1	     4	  leak	       HMR_3288	     0	     0	     1	     2</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% FADH2tx	fadh2[c] 	&lt;=&gt;	fadh2[x]</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% r1290	fadh2[m] + fad[c] 	-&gt;	fad[m] + fadh2[c]</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% HMR_3288	fad[m] + C05280[m] 	-&gt;	fadh2[m] + C05279[m]</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% HMR_3321	dece4coa[x] 	-&gt;	2 h[x] + dec24dicoa[x]</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">        </span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% If there are a large number of reactions, the formulae for the set of</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% reactions in the minimal leakage mode are not displayed. To access such</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">% reaction and metabolite sets,</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S17">%</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each </span><span class = "S5">heu</span><span class = "S5">ristically internal but stoi</span><span class = "S5">chiometrically inconsistent reaction, find the min cardinality leakage mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            rxnBool=model.SIntRxnBool &amp; model.SInConsistentRxnBool;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            metBool=true(nMet,1);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoRxnMode=0;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [</span><span class = "S12">minLeakMetBool</span><span class = "S12">,</span><span class = "S12">minLeakRxnBool</span><span class = "S12">,</span><span class = "S12">minSiphonMetBool</span><span class = "S12">,</span><span class = "S12">minSiphonRxnBool</span><span class = "S12">,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S12">] =</span><span class = "S18">...</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">                findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each he</span><span class = "S5">u</span><span class = "S5">ristically internal but unkn</span><span class = "S5">own stoichiometric consistency reaction (one at a time), find a minimal cardinality leakage mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            rxnBool=model.SIntRxnBool &amp; model.unknownSConsistencyRxnBool;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            metBool=true(nMet,1);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoRxnMode=1;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">            [</span><span class = "S12">minLeakMetBool</span><span class = "S12">,</span><span class = "S12">minLeakRxnBool</span><span class = "S12">,</span><span class = "S12">minSiphonMetBool</span><span class = "S12">,</span><span class = "S12">minSiphonRxnBool</span><span class = "S12">,</span><span class = "S12">leakY</span><span class = "S12">,</span><span class = "S12">siphonY</span><span class = "S12">,</span><span class = "S12">statp</span><span class = "S12">,</span><span class = "S12">statn</span><span class = "S16">] = findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div></div></div><div class = "S0"></div><div class = 'SectionBlock containment'><h2 class = "S9"><span class = "S5">For each he</span><span class = "S5">u</span><span class = "S5">ristically internal but unkn</span><span class = "S5">own stoichiometric consistency reaction, find a minimal cardinality leakage mode</span></h2><div class = 'LineNodeBlock contiguous'><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S14">if </span><span class = "S16">1</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            rxnBool=model.SIntRxnBool &amp; model.unknownSConsistencyRxnBool;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            metBool=true(nMet,1);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            minLeakParams.monoRxnMode=0;</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] = findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        </span><span class = "S18">end</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16"></span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    </span><span class = "S14">if </span><span class = "S16">printLevel&gt;0</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        fprintf(</span><span class = "S15">'%6u\t%6u\t%s\n'</span><span class = "S12">,nnz(~model.SIntMetBool),nnz(~model.SIntRxnBool),</span><span class = "S15">' heuristically exchange.'</span><span class = "S16">)</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        fprintf(</span><span class = "S15">'%6u\t%6u\t%s\n'</span><span class = "S12">,nnz(model.SIntMetBool),nnz(model.SIntRxnBool),</span><span class = "S15">' All internally stoichiometrically consistent.'</span><span class = "S16">);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        fprintf(</span><span class = "S15">'%6u\t%6u\t%s\n'</span><span class = "S12">,nnz(model.fluxConsistentMetBool),nnz(model.fluxConsistentRxnBool),</span><span class = "S15">' All flux consistent.'</span><span class = "S16">);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">        fprintf(</span><span class = "S15">'%s\n'</span><span class = "S12">,</span><span class = "S15">'Input model assumed to be stoichiometrically and flux consistent.'</span><span class = "S16">);</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S12">    </span><span class = "S18">end</span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">    </span></div></div><div class = 'inlineWrapper'><div class = "S11 lineNode"><span class = "S16">    </span></div></div></div><h2 class = "S4"><span class = "S5">REFE</span><span class = "S5">RENCES</span></h2><div class = "S3"><span class = "S5">Gevorgyan, A., Poolman, M. G., Fell D., Detection of stoichiometric inconsistencies in biomolecular models. Bioinformatics, 24(19):2245–51, 2008.</span></div><div class = "S3"><span class = "S5">Flem</span><span class = "S5">ing, R.M.T., et al., Cardinality optimisation in constraint-based modelling: Application to Recon 3D (submitted), 2017.</span></div><div class = "S3"><span class = "S5">Brunk, E. et al. Recon 3D: A resource enabling a three-dimensional view of gene variation in human metabolism. (submitted) 2017.</span></div></div></div>
<!-- 
##### SOURCE BEGIN #####
%% *Find leakage and siphon modes in a reconstruction  *
% **
% 
% *Note: This tutorial is a draft and needs completion. Contributions welcome!*
% 
% **
%% *Author: Ronan Fleming, University of Luxembourg*
%% *Reviewers: *
%% INTRODUCTION
% In standard notation, flux balance analysis is the linear optimisation (1)
% 
% $$\begin{array}{ll}\min\limits _{v} & \rho(v)\equiv c^{T}v\\\text{s.t.} 
% & Sv=b,\\ & l\leq v\leq u,\end{array}$$
% 
% 
% 
% where    c  is a parameter vector that linearly combines one or more reaction 
% fluxes to form what is termed the objective function and where  b represents 
% some fixed output, or input, of species. If    b=0   , a species may be produced 
% from nothing (leak species) or consumed for nothing (siphon species) in violation 
% of mass conservation, if all reactions are reversible and  S  is stoichiometrically 
% consistent. However, even with a stoichiometrically inconsistent  S, mass conservation 
% may still not be violated if the lower and upper bounds on reaction rates,    
% l,u prevent it. For instance, the reactions    A+B ⇋ C    and    C ⇋ A    are 
% stoichiometrically inconsistent because it is impossible to assign a positive 
% molecular mass to all species whilst ensuring that each reaction conserves mass. 
% However, if the bounds are such that both reactions are unidirectional in the 
% forward direction,    A+B → C    and    C → A   , then leakage of  B  is no 
% longer possible and so mass is conserved. 
% 
% Testing for leaks or siphons has been widely used in genome-scale metabolic 
% modelling, prior to distribution of a model for prediction of mass conserved 
% steady states. One can identify all leaks in a network with the cardinality 
% optimisation problem (2)
% 
% $$\begin{array}{ll}\min\limits _{v,y} & \Vert y\Vert_{0}\\\text{s.t.} & 
% Sv-y=0,\\ & l\leq v\leq u,\\ & 0\le y,\end{array}$$
% 
% where  y_i   ≠ 0    indicates that the corresponding species is a leak 
% and can be produced from nothing. To test for siphons, replace the equality 
% constraint in with    Sv+y=0. This approach is useful when double checking stoichiometric 
% consistency, with the bounds for all reactions that are known to be stoichiometrically 
% inconsistent set to zero. A minimal number of reactions required to be active 
% and result in a leak of the species subset   Ω   can be found using the cardinality 
% optimisation problem (3)
% 
% $$\begin{array}{ll}\min\limits _{v,y} & \Vert v\Vert_{0}\\\text{s.t.} & 
% Sv-y=0,\\ & l\leq v\leq u,\\ & 0\le y,\\ & 1\le y_{i},\;i\in\Omega\end{array}$$
% 
% with the optimal v referred to as a minimal leakage mode [<#LyXCite-gevorgyan_detection_2008 
% gevorgyan_detection_2008>]. A minimal siphon mode would be obtained if the equality 
% constraint was replaced with    Sv+y=0. Similarly, a minimal number of reactions 
% contributing to leakage of a minimal number of species can be found using the 
% cardinality optimisation problem (4)
% 
% $$\begin{array}{ll}\min\limits _{v,y} & \Vert v\Vert_{0}+\Vert y\Vert_{0}\\\text{s.t.} 
% & Sv-y=0,\\ & l\leq v\leq u,\\ & 1\le v_{j},\;j\in\Omega\\ & 0\le y,\end{array}$$
% 
% where the additional inequality enforces the rate of a subset reactions 
% to be active. The utility of Problems <#eq_minimalLeakMet (3)> and <#eq_minimalLeakRxn 
% (4)> is in the identification of reactions within the suspect stoichiometrically 
% inconsistent set, to remove prior to reiteration of a test for stoichiometric 
% consistency with a reduced network. This requires manual curation of the results 
% of Problems <#eq_minimalLeakMet (3)> and <#eq_minimalLeakRxn (4)>, where the 
% advantage is that they often narrow down significantly the search for stoichiometrically 
% inconsistent reactions, especially in the context of genome-scale networks. 
% This tutorial illustrates the methods to implement the aforementioned problems 
% when debugging the source of stoichiometric inconsistency within a reconstruction 
% as it can be used to find leak or siphon metabolites, as well as minimal cardinality 
% leakage modes and minimal cardinality siphon modes, of various types. 
%% TIMING
% Hours to days, depending on how long it takes to biochemically interpret the 
% minimal leakage and siphon modes.
%% PROCEDURE
%% Select reconstruction to convert into a model and enter parameters
% Load the ReconX reconstruction, and save the original reconstruction in the 
% workspace, unless it is already loaded into the workspace. 
%%
clear model
if ~exist('modelOrig','var')
    %select your own model, or use Recon2.0model instead
    if 0
        filename='Recon3.0model';
        directory='~/work/sbgCloud/programReconstruction/projects/recon2models/data/reconXComparisonModels';
        model = loadIdentifiedModel(filename,directory);
    else
        filename='Recon2.0model.mat';
        if exist('Recon2.0model.mat','file')==2
            model = readCbModel(filename);
        end
    end
    model.csense(1:size(model.S,1),1)='E';
    modelOrig = model;
else
    model=modelOrig;
end
%% 
% Set the level of printing, zero for silent, higher for more output.

printLevel=2;
%% 
% Choose the directory to place the results

basePath='~/work/sbgCloud/';
resultsPath=[basePath '/programReconstruction/projects/recon2models/results/reconXs/' model.modelID];
resultsFileName=[resultsPath filesep model.modelID];
%% 
% Create and enter the folder for the results if it does not already exist

if ~exist(resultsPath,'dir')
    mkdir(resultsPath)
end
cd(resultsPath)
%% 
% Optionally create a diary to save the output in case it is very long, 
% this makes it easier to search, especially when debugging the process during 
% the early stages.

if 0
    diary([resultsFileName '_diary.txt'])
end
%% Overview some of the key properties of the reconstruction
% Noting the initial size of the reconstruction is useful for comparisons later 
% with subsets derived according to mathematical specifications.
%%
[nMet,nRxn]=size(model.S);
fprintf('%6s\t%6s\n','#mets','#rxns')
fprintf('%6u\t%6u\t%s\n',nMet,nRxn,' totals.')
%% 
% 
%% Find leakage or siphons in heuristically internal part using the bounds given with the model
%%
        if 1
            [leakMetBool,leakRxnBool,siphonMetBool,siphonRxnBool,leakY,siphonY,statp,statn]...
                = findMassLeaksAndSiphons(model,model.SIntMetBool,model.SIntRxnBool,modelBoundsFlag,leakParams,printLevel);
        end
%% For each leaking metabolite find a minimal cardinality leakage mode
%%
        leakParams.epsilon=1e-4;
        minLeakParams.eta = getCobraSolverParams('LP', 'feasTol')*100;
        leakParams.method='dc';
        
        if 1
            minLeakParams.monoMetMode=1;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] =...
                findMinimalLeakageModeMet(model,leakMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);
        end
%% For each siphon metabolite find a minimal cardinality siphon mode
%%
        if 1
            minLeakParams.monoMetMode=1;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] =...
                findMinimalLeakageModeMet(model,siphonMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);
        end
%% For each leaking metabolite find a minimal cardinality leakage mode
%%
        if 1
            minLeakParams.monoMetMode=0;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] =...
                findMinimalLeakageModeMet(model,leakMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);
        end
%% For each siphon metabolite find a minimal cardinality siphon mode
%%
        if 1
            minLeakParams.monoMetMode=0;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] =...
                findMinimalLeakageModeMet(model,siphonMetBool,model.SIntRxnBool,modelBoundsFlag,minLeakParams,printLevel);
        end
%% For each heuristically internal but stoichiometrically inconsistent reaction (one at a time), find the min cardinality leakage mode
%%
        if 1
            rxnBool=model.SIntRxnBool & model.SInConsistentRxnBool;
            metBool=true(nMet,1);
            minLeakParams.monoRxnMode=1;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] =...
                findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);
        end
        
        % An example of a minimal cardinality leakage mode that causes leakage of no2[c]:
        %
        %  #mets	 #rxns	  mode	        rxnAbbr	    lb	    ub	 newlb	 newub
        %      1	     2	  leak	        RE2704C	     0	     0	     1	     2
        %
        % If there are a small number of reactions, the formulae for the set of
        % reactions in the minimal leakage mode are displayed:
        %
        % RE2704C	yvite[c] 	->	h[c] + no2[c] + CE7047[c]
        % HMR_6456	h[c] + CE7047[c] 	<=>	yvite[c]
        %
        % If RE2704C goes in the forward direction and HMR_6456 in reverse, then
        % no2[c] will leak from the network. One or other of these reactions have
        % the incorrect stoichiometry.
        %
        % Here is a minimal leakage mode resulting in leakage of one metabolite
        %  #mets	 #rxns	  mode	        rxnAbbr	    lb	    ub	 newlb	 newub
        %      1	     4	  leak	       HMR_3288	     0	     0	     1	     2
        % FADH2tx	fadh2[c] 	<=>	fadh2[x]
        % r1290	fadh2[m] + fad[c] 	->	fad[m] + fadh2[c]
        % HMR_3288	fad[m] + C05280[m] 	->	fadh2[m] + C05279[m]
        % HMR_3321	dece4coa[x] 	->	2 h[x] + dec24dicoa[x]
        
        % If there are a large number of reactions, the formulae for the set of
        % reactions in the minimal leakage mode are not displayed. To access such
        % reaction and metabolite sets,
        %
        %
%% For each heuristically internal but stoichiometrically inconsistent reaction, find the min cardinality leakage mode
%%
        if 1
            rxnBool=model.SIntRxnBool & model.SInConsistentRxnBool;
            metBool=true(nMet,1);
            minLeakParams.monoRxnMode=0;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] =...
                findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);
        end
%% For each heuristically internal but unknown stoichiometric consistency reaction (one at a time), find a minimal cardinality leakage mode
%%
        if 1
            rxnBool=model.SIntRxnBool & model.unknownSConsistencyRxnBool;
            metBool=true(nMet,1);
            minLeakParams.monoRxnMode=1;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] = findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);
        end
%% For each heuristically internal but unknown stoichiometric consistency reaction, find a minimal cardinality leakage mode
%%
        if 1
            rxnBool=model.SIntRxnBool & model.unknownSConsistencyRxnBool;
            metBool=true(nMet,1);
            minLeakParams.monoRxnMode=0;
            [minLeakMetBool,minLeakRxnBool,minSiphonMetBool,minSiphonRxnBool,leakY,siphonY,statp,statn] = findMinimalLeakageModeRxn(model,rxnBool,metBool,modelBoundsFlag,minLeakParams,printLevel);
        end

    if printLevel>0
        fprintf('%6u\t%6u\t%s\n',nnz(~model.SIntMetBool),nnz(~model.SIntRxnBool),' heuristically exchange.')
        fprintf('%6u\t%6u\t%s\n',nnz(model.SIntMetBool),nnz(model.SIntRxnBool),' All internally stoichiometrically consistent.');
        fprintf('%6u\t%6u\t%s\n',nnz(model.fluxConsistentMetBool),nnz(model.fluxConsistentRxnBool),' All flux consistent.');
        fprintf('%s\n','Input model assumed to be stoichiometrically and flux consistent.');
    end
    
    
%% REFERENCES
% Gevorgyan, A., Poolman, M. G., Fell D., Detection of stoichiometric inconsistencies 
% in biomolecular models. Bioinformatics, 24(19):2245–51, 2008.
% 
% Fleming, R.M.T., et al., Cardinality optimisation in constraint-based modelling: 
% Application to Recon 3D (submitted), 2017.
% 
% Brunk, E. et al. Recon 3D: A resource enabling a three-dimensional view 
% of gene variation in human metabolism. (submitted) 2017.
##### SOURCE END #####
--></body></html>