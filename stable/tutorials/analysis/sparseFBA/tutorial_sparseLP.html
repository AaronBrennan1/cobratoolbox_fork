<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2022b"><title>Sparse Linear Optimisation</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 20px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.S2 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S3 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: center;  }
.S4 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S5 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S6 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 0 10px 0; }
.S7 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 1px solid rgb(191, 191, 191); border-bottom: 1px solid rgb(191, 191, 191); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 1px solid rgb(191, 191, 191); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 1px solid rgb(191, 191, 191); border-right: 1px solid rgb(191, 191, 191); border-top: 0px none rgb(33, 33, 33); border-bottom: 1px solid rgb(191, 191, 191); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Sparse Linear Optimisation</span></h1><h2  class = 'S1'><span>Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.</span></h2><h2  class = 'S1'><span>Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.</span></h2><h2  class = 'S1'><span>INTRODUCTION</span></h2><div  class = 'S2'><span>In this tutorial, we will show how to use the sparse LP solver. This solver aims to solve the following optimisation problem</span></div><div  class = 'S3'><span texencoding="\begin{array}{ll}
\min &amp; \Vert x\Vert_{0}\\
s.t &amp; A_{eq}x=b_{eq}\\
 &amp; A_{ieq}x\leq b_{ieq}\\
 &amp; l\leq x\leq u
\end{array}" style="vertical-align:-40px"><img src="data:image/png;base64,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" width="106.5" height="91" /></span></div><div  class = 'S2'><span>It has been proved that zero-norm is a non-convex function and the minimisation of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively developed. For a complete study of non-convex approximations of zero-norm, the reader is referred to Le Thie et al. (2015)</span><span texencoding="^1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAoCAYAAAAYGBGfAAAAAXNSR0IArs4c6QAAAK9JREFUSEvtlT0OAiEQRr8hFJ7BAhju4U2s/Ck8hI2lRzDReBVbC4+A7DG2AKyMiatmd0NlhgM8yJuXgVDhUAUGBNK1+NOJMcZrrbc550uM8fxtCB8hzjmnlNqUUuYApkS0DCGchkImMcaWmVcADqMgzxu994tSylEgrxmIk26PVZww83p0sdZaVkrNAOwAWABXItqnlG5N09zf3yybbeBm6/udiFgR26cV6eTvO3kA0nxwKbWvgwYAAAAASUVORK5CYII=" width="8.5" height="20" /></span><span>.</span></div><div  class = 'S2'><span>The method is described in Le Thie et al. (2015)</span><span texencoding="^1" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAoCAYAAAAYGBGfAAAAAXNSR0IArs4c6QAAAK9JREFUSEvtlT0OAiEQRr8hFJ7BAhju4U2s/Ck8hI2lRzDReBVbC4+A7DG2AKyMiatmd0NlhgM8yJuXgVDhUAUGBNK1+NOJMcZrrbc550uM8fxtCB8hzjmnlNqUUuYApkS0DCGchkImMcaWmVcADqMgzxu994tSylEgrxmIk26PVZww83p0sdZaVkrNAOwAWABXItqnlG5N09zf3yybbeBm6/udiFgR26cV6eTvO3kA0nxwKbWvgwYAAAAASUVORK5CYII=" width="8.5" height="20" /></span><span>. The sparse LP solver contains one convex (one-norm) and 6 non-convex approximation of zero-norms</span></div><ul  class = 'S4'><li  class = 'S5'><span>Capped-L1 norm</span></li><li  class = 'S5'><span>Exponential function</span></li><li  class = 'S5'><span>Logarithmic function</span></li><li  class = 'S5'><span>SCAD (Smoothly Clipped Absolute Deviation) function</span></li><li  class = 'S5'><span>p norm with </span><span> </span><span>  </span><span>p</span><span>&lt;</span><span>0</span><span>  </span><span> </span><span> </span></li><li  class = 'S5'><span>p norm with </span><span> </span><span>  </span><span>0</span><span>&lt;</span><span>p</span><span>&lt;</span><span>1</span><span>  </span><span> </span></li></ul><div  class = 'S2'><span>The tutorial consist of two parts. Part 1 shows a basic usage of the solver. In part 2 provides an application of the code for finding the minimal set of reactions subject to a LP objective. Ready-made scripts are provided for both parts.</span></div><h2  class = 'S6'><span>EQUIPMENT SETUP</span></h2><h2  class = 'S1'><span style=' font-weight: bold;'>Initialize the COBRA Toolbox.</span></h2><div  class = 'S2'><span>If necessary, initialize The Cobra Toolbox using the </span><span style=' font-family: monospace;'>initCobraToolbox</span><span> function.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >initCobraToolbox(false) </span><span style="color: rgb(0, 128, 19);">% false, as we don't want to update</span></span></div></div></div><h2  class = 'S6'><span>COBRA model. </span></h2><div  class = 'S2'><span>In thi</span><span>s tutorial, the model used</span><span> is the generic reconstruction of human metabolism, the Recon 2.04</span><span texencoding="^2" style="vertical-align:-5px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAoCAYAAAAYGBGfAAAAAXNSR0IArs4c6QAAAbhJREFUSEvt1D9IW1EUBvDv3DwiZKodQ8i79/WB0IBLhw5dMrUWBCd3B0EoFLIIOuji0KWDa3GRDB1a7d5ByORQ2sEhqPDywk3TdOgQRBFCmnNKIEI0efkD6fbefN+Pe75z7iHM4KMZGIiRwRSHZmKMcUXkHREtAZgH8IOZd6y1XwHwQ2YA8X0/1+l0jgCcEdGliDwD8LL343q1Wi2ORHzfn2PmfQDfwjA8BCAAyPO8NRH5AOB7IpFYCYLgTz907yau6xqlVKHVam03Go3bu4OZTOax4zifiegJM7+21p5HIrlcLtlsNp1+oHs4nU6nksnkARE9bbfby/V6/VckEjW9WutHRPRJRH46jvMmCILW1IgxZlFEviilNsIwPBnbnYcH8vm8U6vV3gO4ymaze6VS6e/UiNb6FRGtplKpQrlcvhlW8sgHqLV+TkRvmXnTWvs7KrNIpDd0u8xcGAV04aFIFNDNx1pbYOZja2317mYDiDFmAUBRRAKlVNBfQu8JXLiuu9Uf8D3E87ysiHwE8CKi/mul1FKlUjmdek7GrdB4PU64HscFOfXbmQSMuxN3J56TSRL4T3PyD8g6qilDYcPkAAAAAElFTkSuQmCC" width="8.5" height="20" /></span><span>, which is provided in the COBRA Toolbox. The Recon 2.04 model can also be downloaded from the </span><a href = "https://www.vmh.life/#downloadview"><span>Virtual Metabolic Human</span></a><span> webpage. You can also select your own model to work with. Before proceeding with the simulations, the path for the model needs to be set up:      </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">global</span><span style="color: rgb(14, 0, 255);"> </span><span >CBTDIR</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelFileName = </span><span style="color: rgb(167, 9, 245);">'Recon2.v04.mat'</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelDirectory = getDistributedModelFolder(modelFileName); </span><span style="color: rgb(0, 128, 19);">%Look up the folder for the distributed Models.</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >modelFileName= [modelDirectory filesep modelFileName]; </span><span style="color: rgb(0, 128, 19);">% Get the full path. Necessary to be sure, that the right model is loaded</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >model = readCbModel(modelFileName);</span></span></div></div></div><div  class = 'S11'><span style=' font-weight: bold;'>NOTE: The following text, code, and results are shown for the Recon 2.04 model</span></div><h2  class = 'S6'><span>PROCEDUR</span><span>E</span></h2><h2  class = 'S1'><span>Example of using</span><span> sparseLP solver on randomly generated data</span></h2><div  class = 'S2'><span>One randomly generates a m</span><span>atrix </span><span texencoding="A\in\mathcal{R}^{^{m\times n}}" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="66" height="22" /></span><span> </span><span>  and a vector </span><span texencoding="x_{0}\in\mathcal{R}^{^{n}}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="52.5" height="23.5" /></span><span> </span><span>. The right hand side vector</span><span> </span><span texencoding="b=A\cdot x_{0}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="62.5" height="19.5" /></span><span>. There are three optional inputs for the method.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >n = 100; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >m = 50; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >x0 = rand(n,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.A = rand(m,n); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.b = constraint.A*x0; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.lb = -1000*ones(n,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.ub = 1000*ones(n,1); </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >constraint.csense = repmat(</span><span style="color: rgb(167, 9, 245);">'E'</span><span >, m, 1); </span></span></div></div></div><div  class = 'S11'><span>The two first: maximum number of iterations (</span><span style=' font-style: italic;'>nbMaxIteration</span><span>) and threshold (</span><span style=' font-style: italic;'>epsilon</span><span>) are stopping criterion conditions. </span><span style=' font-style: italic;'>theta</span><span> is the parameter of zero-norm approximation. The greater the value of </span><span style=' font-style: italic;'>theta</span><span>, the better the approximation of the zero-norm. However, the greater the value of </span><span style=' font-style: italic;'>theta</span><span>, the more local solutions the problem has. If the value of </span><span style=' font-style: italic;'>theta </span><span>is not given then the algorithm will use a default value and update it gradually.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >params.nbMaxIteration = 100;    </span><span style="color: rgb(0, 128, 19);">% stopping criteria</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >params.epsilon = 1e-6; 		</span><span style="color: rgb(0, 128, 19);">% stopping criteria</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >params.theta   = 2;    		 </span><span style="color: rgb(0, 128, 19);">% parameter of l0 approximation </span></span></div></div></div><div  class = 'S11'><span>Call the solver with a chosen approximation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >solution = sparseLP(</span><span style="color: rgb(167, 9, 245);">'cappedL1'</span><span >,constraint,params); </span></span></div></div></div><div  class = 'S11'><span>or with default parameter</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%solution = sparseLP('cappedL1',constraint);</span></span></div></div></div><h2  class = 'S1'><span>Finding the minimal set of reactions subject to a LP objective</span></h2><div  class = 'S2'><span>Set the tolerance to distinguish between zero and non-zero flux, based on the numerical tolerance of the currently installed optimisation solver.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >feasTol = getCobraSolverParams(</span><span style="color: rgb(167, 9, 245);">'LP'</span><span >, </span><span style="color: rgb(167, 9, 245);">'feasTol'</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Select the biomass reaction to optimise</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >model.biomassBool=strcmp(model.rxns,</span><span style="color: rgb(167, 9, 245);">'biomass_reaction'</span><span >);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >model.c(model.biomassBool)=1;</span></span></div></div></div><div  class = 'S11'><span>We will firstly find the optimal value subject to a LP objective</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%% Solve FBA  </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% max c'v </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% s.t   Sv = b </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">%       l &lt;= v &lt;= u</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Define the LP structure </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >[m,n] = size(S); </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >LPproblem = struct(</span><span style="color: rgb(167, 9, 245);">'c'</span><span >,-c,</span><span style="color: rgb(167, 9, 245);">'osense'</span><span >,1,</span><span style="color: rgb(167, 9, 245);">'A'</span><span >,S,</span><span style="color: rgb(167, 9, 245);">'csense'</span><span >,csense,</span><span style="color: rgb(167, 9, 245);">'b'</span><span >,b,</span><span style="color: rgb(167, 9, 245);">'lb'</span><span >,lb,</span><span style="color: rgb(167, 9, 245);">'ub'</span><span >,ub);  </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Call solveCobraLP to solve the LP </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >LPsolution = solveCobraLP(LPproblem);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >vFBA = LPsolution.full;</span></span></div></div></div><div  class = 'S11'><span>We will now find the minimum number of reactions needed to achieve the same max objective found previously. Then one will add one more constraint: </span><span texencoding="$c^{T}v=c^{T}v_{FBA}=:f_{FBA}$" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="127" height="21.5" /></span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >constraint.A = [S ; c']; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.b = [b ; c'*vFBA]; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.csense = [csense;</span><span style="color: rgb(167, 9, 245);">'E'</span><span >];</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >constraint.lb = lb; </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >constraint.ub = ub;</span></span></div></div></div><div  class = 'S11'><span>Call the sparseLP solver to solve the problem</span></div><div  class = 'S3'><span texencoding="
\begin{array}{ll}
\min &amp; \Vert v\Vert_{0}\\
s.t &amp; Sv=b\\
 &amp; c^{T}v=f_{FBA}\\
 &amp; l\leq v\leq u
\end{array}" style="vertical-align:-40px"><img src="data:image/png;base64,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" width="100.5" height="91" /></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Try all non-convex approximations of zero norm and take the best result </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >approximations = {</span><span style="color: rgb(167, 9, 245);">'cappedL1'</span><span >,</span><span style="color: rgb(167, 9, 245);">'exp'</span><span >,</span><span style="color: rgb(167, 9, 245);">'log'</span><span >,</span><span style="color: rgb(167, 9, 245);">'SCAD'</span><span >,</span><span style="color: rgb(167, 9, 245);">'lp-'</span><span >,</span><span style="color: rgb(167, 9, 245);">'lp+'</span><span >}; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >bestResult = n; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >bestAprox = </span><span style="color: rgb(167, 9, 245);">''</span><span >; </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:length(approximations)     </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >	solution = sparseLP(char(approximations(i)),constraint);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >	</span><span style="color: rgb(14, 0, 255);">if </span><span >solution.stat == 1         </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >		</span><span style="color: rgb(14, 0, 255);">if </span><span >bestResult &gt; length(find(abs(solution.x)&gt;eps))             </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >			bestResult=length(find(abs(solution.x)&gt;eps));             </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >			bestAprox = char(approximations(i));             </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >			solutionL0 = solution;         </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >		</span><span style="color: rgb(14, 0, 255);">end</span><span >     </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >	</span><span style="color: rgb(14, 0, 255);">end </span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end </span></span></div></div></div><div  class = 'S11'><span>Now we call the sparse linear step function approximations  </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >bestResult = n;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >bestAprox = </span><span style="color: rgb(167, 9, 245);">''</span><span >;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:length(approximations)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    solution = sparseLP(char(approximations(i)),constraint);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">if </span><span >solution.stat == 1</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        nnzSol=nnz(abs(solution.x)&gt;feasTol);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        fprintf(</span><span style="color: rgb(167, 9, 245);">'%u%s%s'</span><span >,nnzSol,</span><span style="color: rgb(167, 9, 245);">' active reactions in the sparseFBA solution with '</span><span >, char(approximations(i)))</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">if </span><span >bestResult &gt; nnzSol</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >            bestResult=nnzSol;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >            bestAprox = char(approximations(i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >            solutionL0 = solution;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >        </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S11'><span>Select the most sparse flux vector, unless there is a numerical problem.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >~isequal(bestAprox,</span><span style="color: rgb(167, 9, 245);">''</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    vBest = solutionL0.x;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    vBest = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    error(</span><span style="color: rgb(167, 9, 245);">'Min L0 problem error !!!!'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><div  class = 'S11'><span>Report the best approximation</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >display(strcat(</span><span style="color: rgb(167, 9, 245);">'Best step function approximation: '</span><span >,bestAprox))</span></span></div></div></div><div  class = 'S11'><span>Report the number of active reactions in the most sparse flux vector</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">'%u%s'</span><span >,nnz(abs(vBest)&gt;feasTol),</span><span style="color: rgb(167, 9, 245);">' active reactions in the best sparse flux balance analysis solution.'</span><span >)</span></span></div></div></div><div  class = 'S11'><span>Warn if there might be a numerical issue with the solution</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >feasError=norm(constraint.A * solutionL0.x - constraint.b,2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >feasError&gt;feasTol</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    fprintf(</span><span style="color: rgb(167, 9, 245);">'%g\t%s\n'</span><span >,feasError, </span><span style="color: rgb(167, 9, 245);">' feasibily error.'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >    warning(</span><span style="color: rgb(167, 9, 245);">'Numerical issue with the sparseLP solution'</span><span >)</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div><h2  class = 'S6'><span>REFERENCES</span></h2><div  class = 'S2'><span style=' font-style: italic;'> </span><span>[1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation approaches for sparse</span><span> </span><span>optimization</span><span>. European Journal of Operational Research 244, 26–46.</span></div><div  class = 'S2'><span>[2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). A community-driven global reconstruction of human metabolism. Nat Biotechnol 31, 419-425.</span></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Sparse Linear Optimisation
%% Author: Ronan Fleming, Hoai Minh Le, Systems Biochemistry Group, University of Luxembourg.
%% Reviewer: Stefania Magnusdottir, Molecular Systems Physiology Group, University of Luxembourg.
%% INTRODUCTION
% In this tutorial, we will show how to use the sparse LP solver. This solver 
% aims to solve the following optimisation problem
% 
% $$\begin{array}{ll}\min & \Vert x\Vert_{0}\\s.t & A_{eq}x=b_{eq}\\ & A_{ieq}x\leq 
% b_{ieq}\\ & l\leq x\leq u\end{array}$$
% 
% It has been proved that zero-norm is a non-convex function and the minimisation 
% of zero-norm is a NP-hard problem. Non-convex approximations of zero-norm extensively 
% developed. For a complete study of non-convex approximations of zero-norm, the 
% reader is referred to Le Thie et al. (2015)$^1$.
% 
% The method is described in Le Thie et al. (2015)$^1$. The sparse LP solver 
% contains one convex (one-norm) and 6 non-convex approximation of zero-norms
%% 
% * Capped-L1 norm
% * Exponential function
% * Logarithmic function
% * SCAD (Smoothly Clipped Absolute Deviation) function
% * p norm with    p<0    
% * p norm with    0<p<1   
%% 
% The tutorial consist of two parts. Part 1 shows a basic usage of the solver. 
% In part 2 provides an application of the code for finding the minimal set of 
% reactions subject to a LP objective. Ready-made scripts are provided for both 
% parts.
%% EQUIPMENT SETUP
%% *Initialize the COBRA Toolbox.*
% If necessary, initialize The Cobra Toolbox using the |initCobraToolbox| function.

initCobraToolbox(false) % false, as we don't want to update
%% COBRA model. 
% In this tutorial, the model used is the generic reconstruction of human metabolism, 
% the Recon 2.04$^2$, which is provided in the COBRA Toolbox. The Recon 2.04 model 
% can also be downloaded from the <https://www.vmh.life/#downloadview Virtual 
% Metabolic Human> webpage. You can also select your own model to work with. Before 
% proceeding with the simulations, the path for the model needs to be set up:      

global CBTDIR
modelFileName = 'Recon2.v04.mat';
modelDirectory = getDistributedModelFolder(modelFileName); %Look up the folder for the distributed Models.
modelFileName= [modelDirectory filesep modelFileName]; % Get the full path. Necessary to be sure, that the right model is loaded
model = readCbModel(modelFileName);
%% 
% *NOTE: The following text, code, and results are shown for the Recon 2.04 
% model*
%% PROCEDURE
%% Example of using sparseLP solver on randomly generated data
% One randomly generates a matrix $A\in\mathcal{R}^{^{m\times n}}$   and a vector 
% $x_{0}\in\mathcal{R}^{^{n}}$ . The right hand side vector $b=A\cdot x_{0}$. 
% There are three optional inputs for the method.

n = 100; 
m = 50; 
x0 = rand(n,1); 
constraint.A = rand(m,n); 
constraint.b = constraint.A*x0; 
constraint.lb = -1000*ones(n,1); 
constraint.ub = 1000*ones(n,1); 
constraint.csense = repmat('E', m, 1); 
%% 
% The two first: maximum number of iterations (_nbMaxIteration_) and threshold 
% (_epsilon_) are stopping criterion conditions. _theta_ is the parameter of zero-norm 
% approximation. The greater the value of _theta_, the better the approximation 
% of the zero-norm. However, the greater the value of _theta_, the more local 
% solutions the problem has. If the value of _theta_ is not given then the algorithm 
% will use a default value and update it gradually.

params.nbMaxIteration = 100;    % stopping criteria
params.epsilon = 1e-6; 		% stopping criteria
params.theta   = 2;    		 % parameter of l0 approximation 
%% 
% Call the solver with a chosen approximation

solution = sparseLP('cappedL1',constraint,params); 
%% 
% or with default parameter

%solution = sparseLP('cappedL1',constraint);
%% Finding the minimal set of reactions subject to a LP objective
% Set the tolerance to distinguish between zero and non-zero flux, based on 
% the numerical tolerance of the currently installed optimisation solver.

feasTol = getCobraSolverParams('LP', 'feasTol');
%% 
% Select the biomass reaction to optimise

model.biomassBool=strcmp(model.rxns,'biomass_reaction');
model.c(model.biomassBool)=1;
%% 
% We will firstly find the optimal value subject to a LP objective

%% Solve FBA  
% max c'v 
% s.t   Sv = b 
%       l <= v <= u
% Define the LP structure 
[c,S,b,lb,ub,csense] = deal(model.c,model.S,model.b,model.lb,model.ub,model.csense); 
[m,n] = size(S); 
LPproblem = struct('c',-c,'osense',1,'A',S,'csense',csense,'b',b,'lb',lb,'ub',ub);  
% Call solveCobraLP to solve the LP 
LPsolution = solveCobraLP(LPproblem);
vFBA = LPsolution.full;
%% 
% We will now find the minimum number of reactions needed to achieve the same 
% max objective found previously. Then one will add one more constraint: $$c^{T}v=c^{T}v_{FBA}=:f_{FBA}$$.

constraint.A = [S ; c']; 
constraint.b = [b ; c'*vFBA]; 
constraint.csense = [csense;'E'];
constraint.lb = lb; 
constraint.ub = ub;
%% 
% Call the sparseLP solver to solve the problem
% 
% $$\begin{array}{ll}\min & \Vert v\Vert_{0}\\s.t & Sv=b\\ & c^{T}v=f_{FBA}\\ 
% & l\leq v\leq u\end{array}$$

% Try all non-convex approximations of zero norm and take the best result 
approximations = {'cappedL1','exp','log','SCAD','lp-','lp+'}; 
bestResult = n; 
bestAprox = ''; 
for i=1:length(approximations)     
	solution = sparseLP(char(approximations(i)),constraint);
	if solution.stat == 1         
		if bestResult > length(find(abs(solution.x)>eps))             
			bestResult=length(find(abs(solution.x)>eps));             
			bestAprox = char(approximations(i));             
			solutionL0 = solution;         
		end     
	end 
end 
%% 
% Now we call the sparse linear step function approximations  

bestResult = n;
bestAprox = '';
for i=1:length(approximations)
    solution = sparseLP(char(approximations(i)),constraint);
    if solution.stat == 1
        nnzSol=nnz(abs(solution.x)>feasTol);
        fprintf('%u%s%s',nnzSol,' active reactions in the sparseFBA solution with ', char(approximations(i)))
        if bestResult > nnzSol
            bestResult=nnzSol;
            bestAprox = char(approximations(i));
            solutionL0 = solution;
        end
    end
end
%% 
% Select the most sparse flux vector, unless there is a numerical problem.

if ~isequal(bestAprox,'')
    vBest = solutionL0.x;
else
    vBest = [];
    error('Min L0 problem error !!!!')
end
%% 
% Report the best approximation

display(strcat('Best step function approximation: ',bestAprox))
%% 
% Report the number of active reactions in the most sparse flux vector

fprintf('%u%s',nnz(abs(vBest)>feasTol),' active reactions in the best sparse flux balance analysis solution.')
%% 
% Warn if there might be a numerical issue with the solution

feasError=norm(constraint.A * solutionL0.x - constraint.b,2);
if feasError>feasTol
    fprintf('%g\t%s\n',feasError, ' feasibily error.')
    warning('Numerical issue with the sparseLP solution')
end
%% REFERENCES
% [1] Le Thi, H.A., Pham Dinh, T., Le, H.M., and Vo, X.T. (2015). DC approximation 
% approaches for sparse optimization. European Journal of Operational Research 
% 244, 26–46.
% 
% [2] Thiele, I., Swainston, N., Fleming, R.M., Hoppe, A., Sahoo, S., Aurich, 
% M.K., Haraldsdottir, H., Mo, M.L., Rolfsson, O., Stobbe, M.D., et al. (2013). 
% A community-driven global reconstruction of human metabolism. Nat Biotechnol 
% 31, 419-425.
##### SOURCE END #####
-->
</div></body></html>